<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>D: 積の総和/SumTotal of product
 - industry test 08 月 15 日 4 回目 | AtCoder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="
">
    <meta name="keyword" content="AtCoder,アットコーダー,あっとこーだー,プログラミングコンテスト
">
    <meta name="author" content="Atcoder" />
    <meta name="copyright" content="Copyright (C) 2012 Atcoder" />
    <meta name="format-detection" content="telephone=no" />

    <link rel="stylesheet" type="text/css" href="/css/all.css?v=2">
    <link rel="stylesheet" type="text/css" href="/css/print.css?v=1" media="print">
        <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <script src="/js/jquery.js"></script>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30554866-3']);
  _gaq.push(['_setDomainName', 'atcoder.jp']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>    
    <!--[if lt IE 9]><style>.navbar-fixed-top{ position: relative!important; }</style><![endif]-->

  </head>


  <body>
          <div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
              <a class="brand" href="/"><span class="contest-name">industry test 08 月 15 日 4 回目</span><span class="bland-small"><time>2015/08/15 11:00:00 +0000</time> ~ <time>2015/08/15 13:00:00 +0000</time></span></a>
      
      <div class="nav-collapse">
                            <ul  id="nav-right-logined" class="nav pull-right" style="display:none;">
            <li class="dropdown">
              <a href="#" lang="ja" class="dropdown-toggle static-nav-language-selector-dropdown" data-toggle="dropdown" style="display:none;">
                <i class="flag-ja"></i> 日本語 <b class="caret"></b>
              </a>
              <a href="#" lang="en" class="dropdown-toggle static-nav-language-selector-dropdown"  data-toggle="dropdown" style="display:none;">
                <i class="flag-en"></i> English <b class="caret"></b>
              </a>
              <a href="#" lang="ko" class="dropdown-toggle static-nav-language-selector-dropdown"  data-toggle="dropdown" style="display:none;">
                <i class="flag-ko"></i> 한국어 <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li> <a lang="ja" class="static-nav-language-selector" href="#"><i class="flag-ja"></i> 日本語</a></li>
                <li> <a lang="en" class="static-nav-language-selector" href="#"><i class="flag-en"></i> English</a></li>
                <li> <a lang="ko" class="static-nav-language-selector" href="#"><i class="flag-ko"></i> 한국어</a></li>
              </ul>
            </li>
            <li class="divider-vertical"></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-cog icon-white"></i> <span id="nav-right-username"></span><b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="/me">マイプロフィール</a></li>
                                	<li><a href="/settings"><span class="lang"><span class="lang-en">Settings</span><span class="lang-ja">設定</span></span></a></li>
                	                	<li><a href="/settings/password"><span class="lang"><span class="lang-en">Change password</span><span class="lang-ja">パスワードの変更</span></span></a></li>
                	<li class="divider"></li>
                                <li><a href="/logout"><span class="lang"><span class="lang-en">Sign out</span><span class="lang-ja">ログアウト</span></span></a></li>
             </ul>
            </li>
          </ul>
          <ul id="nav-right-not-login" class="nav pull-right" style="display:none;">
            <li class="dropdown">
              <a href="#" lang="ja" class="dropdown-toggle static-nav-language-selector-dropdown" data-toggle="dropdown" style="display:none;">
                <i class="flag-ja"></i> 日本語 <b class="caret"></b>
              </a>
              <a href="#" lang="en" class="dropdown-toggle static-nav-language-selector-dropdown"  data-toggle="dropdown" style="display:none;">
                <i class="flag-en"></i> English <b class="caret"></b>
              </a>
              <a href="#" lang="ko" class="dropdown-toggle static-nav-language-selector-dropdown"  data-toggle="dropdown" style="display:none;">
                <i class="flag-ko"></i> 한국어 <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li> <a lang="ja" class="static-nav-language-selector" href="#"><i class="flag-ja"></i> 日本語</a></li>
                <li> <a lang="en" class="static-nav-language-selector" href="#"><i class="flag-en"></i> English</a></li>
                <li> <a lang="ko" class="static-nav-language-selector" href="#"><i class="flag-ko"></i> 한국어</a></li>
              </ul>
            </li>
                        <li class="divider-vertical"></li>
            <li><a href="/register"><span class="lang"><span class="lang-en">Sign up</span><span class="lang-ja">新規登録</span></span></a></li>
                        <li class="divider-vertical"></li>
            <li><a href="/login"><span class="lang"><span class="lang-en">Sign in</span><span class="lang-ja">ログイン</span></span></a></li>
            </li>
          </ul>
      </div>
    </div>
  </div>
</div>
    <div class="modal hide fade" style="display:none;" id="modal-contest-end">
  <div class="modal-header">
    <a class="close" data-dismiss="modal">×</a>
    <h3><span class="lang"><span class="lang-en">industry test 08 月 15 日 4 回目 has ended</span><span class="lang-ja">industry test 08 月 15 日 4 回目が終了しました</span></span></h3>
  </div>
  <div class="modal-body">
    <p><span class="lang"><span class="lang-en">Contest has ended</span><span class="lang-ja">コンテスト終了です</span></span></p>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn" data-dismiss="modal"><span class="lang"><span class="lang-en">Close</span><span class="lang-ja">閉じる</span></span></a>
  </div>
</div>

<div class="modal hide fade" style="display:none;" id="modal-contest-begin">
  <div class="modal-header">
    <a class="close" data-dismiss="modal">×</a>
    <h3><span class="lang"><span class="lang-en">industry test 08 月 15 日 4 回目 is now opening</span><span class="lang-ja">industry test 08 月 15 日 4 回目の開催時間になりました</span></span></h3>
  </div>
  <div class="modal-body">
    <p><span class="lang"><span class="lang-en">Contest has started</span><span class="lang-ja">問題一覧のページへ移動してください</span></span></p>
  </div>
  <div class="modal-footer">
    <a href="/assignments" class="btn btn-primary"><span class="lang"><span class="lang-en">Go to the task list page</span><span class="lang-ja">問題一覧のページへ移動</span></span></a>
  </div>
</div>
    
    <div id="outer-inner" class="container">
      <h1 class="site-title">
          industry test 08 月 15 日 4 回目
      </h1>
                      <time style="display:none" id="contest-start-time">2015/08/15 11:00:00 +0000</time>
        <time style="display:none" id="contest-end-time">2015/08/15 13:00:00 +0000</time>
        <time style="display:none" id="server-current-time">2015/08/15 11:05:27 +0000</time>

            
      <ul class="nav nav-tabs">
                            <li><a href="http://industry-2015-0815-4.contest.atcoder.jp/"><i class="icon-home"></i> <span class="lang"><span class="lang-en">Home</span><span class="lang-ja">トップページ</span><span class="lang-ko">톱 페이지</span></span></a></li>
                                          <li class="active"><a href="http://industry-2015-0815-4.contest.atcoder.jp/assignments"><i class="icon-list-alt"></i> <span class="lang"><span class="lang-en">Tasks</span><span class="lang-ja">問題</span><span class="lang-ko">문제</span></span></a></li>
                                          <li><a href="https://industry-2015-0815-4.contest.atcoder.jp/submit"><i class="icon-upload"></i> <span class="lang"><span class="lang-en">Submit</span><span class="lang-ja">提出</span><span class="lang-ko">제출</span></span></a></li>
                                          <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
              <b class="caret"></b><i class="icon-download-alt"></i> <span class="lang"><span class="lang-en">Results</span><span class="lang-ja">結果</span><span class="lang-ko">채점 결과</span></span>
            </a>
            <ul class="dropdown-menu">
                              <li><a href="https://industry-2015-0815-4.contest.atcoder.jp/submissions/me"><span class="lang"><span class="lang-en">My submissions</span><span class="lang-ja">自分の結果</span><span class="lang-ko">자신의 결과</span></span></a></li>
                          </ul>
          </li>
                      </ul>
        <div id="alert_box" class="alert alert-block" style="display:none">
  <a class="close" data-dismiss="alert">×</a>
  <h4 id="alert_box_heading" class="alert-heading" style="display:none"></h4>
  <p id="alert_box_content"></p>
</div>

      <h2>D - 積の総和/SumTotal of product</h2>
<hr />
<p><span class="lang"><span class="lang-en">Time limit</span><span class="lang-ja">時間制限</span></span> : 2sec / <span class="lang"><span class="lang-en">Stack limit</span><span class="lang-ja">スタック制限</span></span> : 256MB / <span class="lang"><span class="lang-en">Memory limit</span><span class="lang-ja">メモリ制限</span></span> : 256MB</p>

<div id="task-statement">
  <span class="lang">
    <span class="lang-ja">
<div class="part">

    <section>
        <h3>問題文</h3>

        <p>横一列に並んだ <var>N</var> 個の空きマスと，<var>N</var> 個の数 <var>A_1,A_2,...,A_N</var> がある．</p>

        <p><var>N</var> 個の空きマスに，<var>A_1,A_2,...,A_N</var> をちょうど<var>1</var> 回ずつ割り当て，全ての隣接するマスのペアについてそれらに割り当てられている数の積の和を計算したもの <var>S</var> を最大化したい．ただし，いくつかの数については，既に割り当てるマスが確定している．あなたの仕事は，<var>S</var> の最大値を出力することである．</p>

        <p>左から <var>i (1≦i≦N)</var> 番目のマスに割り当てられた数の添字を <var>I_i</var> と表すとき，<var>S</var> は <var>S = A_{I_1}×A_{I_2} + A_{I_2}×A_{I_3} + ... + + A_{I_{N-1}}×A_{I_N}</var> と表せる．</p>

    </section>
</div>
<hr />
<div class="io-style">
    <div class="part">

        <section>
            <h3>入力</h3>

            <p>入力は以下の形式で標準入力から与えられる．</p>

<pre>
<var>N</var>
<var>A_1</var> <var>D_1</var>
<var>A_2</var> <var>D_2</var>
:
<var>A_N</var> <var>D_3</var>
</pre>

            <ul class="simple">

                <li><var>1</var> 行目には，整数 <var>N (1 ≦ N ≦ 16)</var> が与えられる．</li>

                <li><var>2</var> 行目から <var>N</var> 行には，各数に関する情報が与えられる．そのうち　<var>i</var>　行目には，<var>i</var> 番目の整数の値 <var>A_i (-100≦A_i≦100)</var> と，その整数が既に割り当てられているかどうかと，割り当てられている場合どのマスに割り当てられているかを表す整数 <var>D_i </var>(<var>1≦D_i≦N</var> または <var>D_i=-1</var>) が与えられる．<var>D_i≧0</var> のとき，<var>A_i</var> が左から <var>D_i</var> 番目のマスに割り当てられていることを意味する．<var>D_i=-1</var>のとき，その整数はまだ割り当てられていないことを意味する．</li>

                <li>同じマスに複数の数が割り当てられることはない．</li>

            </ul>

        </section>
    </div>

    <div class="part">

        <section>
            <h3>出力</h3>

            <p><var>1</var> 行目には，達成できる <var>S</var> の最大値が書かれている．</p>

            <p>末尾の改行を忘れないこと．</p>

        </section>
    </div>
</div>
<hr />
<div class="part">

    <section>
        <h3>入力例1</h3>

<pre>
5
10 -1
20 -1
50 -1
40 -1
30 -1
</pre>

    </section>
</div>
<div class="part">

    <section>
        <h3>出力例1</h3>

<pre>
4600
</pre>

        <p>例えば，各マスに左から <var>10,30,50,40,20</var> と割り当てることによって， <var>10×30+30×50+50×40+40×20=4600</var> になり，これが達成できる最大値である．</p>

    </section>
</div>
<hr />
<div class="part">

    <section>
        <h3>入力例2</h3>

<pre>
6
10 3
20 -1
50 -1
40 -1
30 -1
60 6
</pre>

    </section>
</div>
<div class="part">

    <section>
        <h3>出力例2</h3>

<pre>
6300
</pre>

        <p>このケースにおいて，左から <var>3</var> 番目のマスに <var>10</var>，<var>6</var> 番目のマスに <var>60</var> を割り当てることは既に決まっている．</p>

        <p>このケースにおいては，各マスに左から <var>20,30,10,40,50,60</var> と割り当てれば最大値 <var>6300</var> を達成できる．</p>

    </section>
</div>
<hr />
<div class="part">

    <section>
        <h3>入力例3</h3>

<pre>
2
100 -1
0 -1
</pre>

    </section>
</div>
<div class="part">

    <section>
        <h3>出力例3</h3>

<pre>
0
</pre>

    </section>
</div>
<hr />
<div class="part">

    <section>
        <h3>入力例4</h3>

<pre>
16
1 -1
-2 -1
3 -1
-4 -1
5 -1
-6 -1
7 -1
-8 -1
9 -1
10 -1
11 -1
12 -1
13 -1
14 -1
15 -1
-16 -1
</pre>

    </section>
</div>
<div class="part">

    <section>
        <h3>出力例4</h3>

<pre>
1342
</pre>

    </section>
</div>
<hr />
<div class="part">

    <section>
        <h3>入力例5</h3>

<pre>
16
-8 -1
0 -1
0 11
8 -1
-10 -1
7 -1
-2 -1
-7 -1
0 -1
-4 -1
-4 8
-10 -1
-4 1
0 -1
-8 -1
6 -1
</pre>

    </section>
</div>
<div class="part">

    <section>
        <h3>出力例5</h3>

<pre>
504
</pre>

    </section>
</div>
</span>

<span class="lang-en">
<div id="task-statement">
<div class="part">

    <section>
        <h3>Question</h3>

        <p>There are <var>N</var> empty cells in a grid that are aligned horizontally in one line and <var>N</var> numbers <var>A_1</var>, <var>A_2</var>, <var>...</var>, <var>A_N</var>.</p>

        <p>The goal is to organize the integers in <var>A_1</var>, <var>A_2</var>, <var>...</var>, <var>A_N</var> to maximize <var>S</var>, where <var>S</var> represents of the sum of the products of all adjacent pairs of numbers.</p>

        <p>Some cells may have already been assigned an integer value and cannot be changed.</p>

        <p>Your program should output the maximum value of <var>S</var>.</p>

        <p>When representing the index for the number that is assigned to the <var>i (1≦i≦N)</var>th cell from the left as <var>I_i</var>, <var>S</var> could be represented as:
            <var>S = A_{I_1}×A_{I_2} + A_{I_2}×A_{I_3}+...++A_{I_{N-1}}×A_{I_N}</var>.</p>

    </section>
</div>
<hr />
<div class="io-style">
    <div class="part">

        <section>
            <h3>Input</h3>

            <p>The input will be given in the following format on Standard Input</p>

<pre>
<var>N</var>
<var>A_1</var> <var>D_1</var>
<var>A_2</var> <var>D_2</var>
:
<var>A_N</var> <var>D_3</var>
</pre>

            <ul class="simple">

                <li>On the 1st line, integer <var>N (1 ≦ N ≦ 16)</var> is given.</li>

                <li>From 2nd line to <var>N</var>th line, information regarding each number is given. The <var>i</var>th line contains the value of the <var>i</var>th integer <var>A_i (-100≦A_i≦100)</var> and an integer <var>D_i (1≦D_i≦N</var> or <var>D_i=-1)</var>. If <var>A_i</var> has not yet been assigned a cell, <var>D_i=-1</var>. Otherwise, the <var>D_i</var> represents the cell to which the integer has been assigned. Specifically, when <var>D_i≦0</var>, it indicates that <var>A_i</var> is assigned to <var>D_i</var>th cell from the left.</li>

                <li>Multiple numbers will not be assigned to the same cell.</li>

            </ul>

        </section>
    </div>
    <div class="part">

        <section>
            <h3>Output</h3>

            <p>On the 1st line, the maximum value of <var>S</var> should be output.</p>

            <p>Ensure that there is a line break following <var>S</var>.</p>

        </section>
    </div>
</div>
<hr />
<div class="part">

    <section>
        <h3>Input Example #1</h3>

<pre>
5
10 -1
20 -1
50 -1
40 -1
30 -1
</pre>

    </section>
</div>
<div class="part">

    <section>
        <h3>Output1 Example 1#</h3>

<pre>
4600
</pre>

        <p>For example, if assigning each cell <var>10</var>, <var>30</var>, <var>50</var>, <var>40</var>, <var>20</var> from the left, it becomes <var>10×30+30×50+50×40+40×20=4600</var>, which is the maximum value one can achieve</p>

    </section>
</div>
<hr />
<div class="part">

    <section>
        <h3>Input Example #2</h3>

<pre>
6
10 3
20 -1
50 -1
40 -1
30 -1
60 6
</pre>

    </section>
</div>
<div class="part">

    <section>
        <h3>Output Example #2</h3>

<pre>
6300
</pre>

        <p>In this case, it is already decided that the 3rd cell from the left will be assigned the number <var>10</var> and the 6th cell from the left the number <var>60</var>.</p>

        <p>In this case, if assigning each cell <var>20</var>, <var>30</var>, <var>10</var>, <var>40</var>, <var>50</var>, <var>60</var> from the left, the maximum value <var>6300</var> will be achieved.</p>

    </section>
</div>
<hr />
<div class="part">

    <section>
        <h3>Input Example #3</h3>

<pre>
2
100 -1
0 -1
</pre>

    </section>
</div>
<div class="part">

    <section>
        <h3>Output Example #3</h3>

<pre>
0
</pre>

    </section>
</div>
<hr />
<div class="part">

    <section>
        <h3>Input Example #4</h3>

<pre>
16
1 -1
-2 -1
3 -1
-4 -1
5 -1
-6 -1
7 -1
-8 -1
9 -1
10 -1
11 -1
12 -1
13 -1
14 -1
15 -1
-16 -1
</pre>

    </section>
</div>
<div class="part">

    <section>
        <h3>Output Example #4</h3>

<pre>
1342
</pre>

    </section>
</div>
<hr />
<div class="part">

    <section>
        <h3>Input Example #5</h3>

<pre>
16
-8 -1
0 -1
0 11
8 -1
-10 -1
7 -1
-2 -1
-7 -1
0 -1
-4 -1
-4 8
-10 -1
-4 1
0 -1
-8 -1
6 -1
</pre>

    </section>
</div>
<div class="part">

    <section>
        <h3>Output Example #5</h3>

<pre>
504
</pre>

    </section>
</div>
</div>

</span>
</span>

</div>


<hr/>
<p><a class="btn btn-primary btn-large" href="/submit?task_id=1156"><span class="lang"><span class="lang-en">Submit</span><span class="lang-ja">提出する</span></span></a></p>

    </div>

    <footer>
        <div id="atcoder-default-lang" style="display: none;" data-lang="en"></div>
<ul>
  <li><a href="/tutorial"><span class="lang"><span class="lang-en">Tutorial</span><span class="lang-ja">チュートリアル</span></span></a></li>
  <li><a href="/rules"><span class="lang"><span class="lang-en">Rules</span><span class="lang-ja">ルール</span></span></a></li>
  <li><a href="/glossary"><span class="lang"><span class="lang-en">Glossary</span><span class="lang-ja">用語集</span></span></a></li>
  <li><a href="/faq"><span class="lang"><span class="lang-en">FAQ</span><span class="lang-ja">よくある質問</span></span></a></li>
</ul>
<p id="copyright">Powered by <a href="http://atcoder.jp">AtCoder.</a></p>
    </footer>

    <p id="fixed-server-timer" style="display: none;"></p>

        <script src="/js/bootstrap.min.js"></script>
    <script src="/js/prettify.js"></script>
    <script src="/js/lang-vb.js"></script>
    <script src="/js/lang-hs.js"></script>
    <script src="/js/varmath.js"></script>
    <script src="/js/script.js?v=2"></script>
  </body>
</html>
